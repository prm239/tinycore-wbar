Index: Bar.cc
===================================================================
RCS file: /mnt/back/repository/c/wbar/Bar.cc,v
retrieving revision 1.3
diff -u -r1.3 Bar.cc
--- Bar.cc	14 Jan 2007 17:13:15 -0000	1.3
+++ Bar.cc	14 Jan 2007 17:20:08 -0000
@@ -168,13 +168,14 @@
 /*}}}*/
 
 /* Icons Scaling *//*{{{*/
-void Bar::transform(int i_num, int i_off){ 
+void Bar::transform(int i_num, int i_off, float fact){ 
     int t_x, t_y, a;
 
     int x0 = (icon_ansd+1) * icon_unit, // last movable pos
 	xx = i_num * icon_unit + i_off, // abs mouse pos
 	rx = xx - icon_unit/2; // relative mouse pos
 
+    float tzoomf = 1.0 + (zoom_factor - 1.0) * fact;
     Icon *cur_ic=0;
 
     /* check wether we're over the icon *//*{{{*/
@@ -192,7 +193,7 @@
 	cur_ic = icons[a];
 
 	if( ((a<i_num)?i_num-a:a-i_num) > icon_ansd ){
-	    t_x = (int)(cur_ic->ox + ((a<i_num)?-1:1) * icon_ansd * b_dd / 2);
+	    t_x = (int)(cur_ic->ox + fact * ((a<i_num)?-1:1) * icon_ansd * b_dd / 2);
 	    t_y = cur_ic->oy;
 
 	    if(cur_ic->size != icon_size || cur_ic->x != t_x || cur_ic->y != t_y){
@@ -211,12 +212,12 @@
 	    cur_ic->csize = cur_ic->size;
 
 	    cur_ic->size = (int)( icon_size * 
-		( 1.0 + (zoom_factor-1.0)/(1.0 + expf(b_scl_a + b_scl_b*rx*rx))/b_scl_d));
+		( 1.0 + (tzoomf-1.0)/(1.0 + expf(b_scl_a + b_scl_b*rx*rx))/b_scl_d));
 
 #ifdef LINEAR_TRASL
-	    cur_ic->x = cur_ic->ox - (int)(icon_ansd * b_dd/2 + b_pos_m * (xx - x0));
+	    cur_ic->x = cur_ic->ox - (int)(fact*(icon_ansd * b_dd/2 - b_pos_m * (xx - x0)));
 #else 
-	    cur_ic->x = cur_ic->ox + (int)(icon_ansd * b_dd/2 * sinf(b_pos_m * rx));
+	    cur_ic->x = cur_ic->ox + (int)(fact*icon_ansd * b_dd/2 * sinf(b_pos_m * rx));
 #endif
 
 	    cur_ic->y = cur_ic->oy - (int)(jump_factor*(cur_ic->size-icon_size));
@@ -345,18 +346,24 @@
 /*}}}*/
 
 /* Refresh *//*{{{*/
-void Bar::refresh(int mouse_x){
+void Bar::refresh(int mouse_x, int mouse_y){
     Icon *cur_ic;
 
     int iNum = iconNumber(mouse_x);
     int iOff = iconOffset(mouse_x);
+    //float iPer = (float)mouse_y / window->h;
+    /* Interpolated from: 
+     * 0    ->  0
+     * wh/2 ->  1 
+     * wh   ->  0 */
+    float iPer = 2.0 * mouse_y / window->h * (2.0 - 2.0 * mouse_y / window->h);
 
     /* on the bar */
     if(mouse_x > (int)(icon_offset + icon_size/2.0) && iNum < (int)icons.size()){
 
 	if(!focused) focus();
 
-	transform(iNum, iOff);
+	transform(iNum, iOff, iPer);
 #ifndef COOLMACHINE_N_SHITCODE
 	cleanBack();
 #endif
@@ -392,8 +399,8 @@
 inline void Bar::unfocus(){
     focused = 0;
 
-    x = (int)icon_offset;
-    width = (int)(window->w - 2*icon_offset);
+    //x = (int)icon_offset;
+    //width = (int)(window->w - 2*icon_offset);
     zoomed_icon = -1;
 
     drawBack();
@@ -402,8 +409,8 @@
 inline void Bar::focus(){
     focused = 1;
 
-    x=0;
-    width = window->w;
+    //x=0;
+    //width = window->w;
 
     drawBack();
 }
Index: Bar.h
===================================================================
RCS file: /mnt/back/repository/c/wbar/Bar.h,v
retrieving revision 1.2
diff -u -r1.2 Bar.h
--- Bar.h	13 Jan 2007 20:57:03 -0000	1.2
+++ Bar.h	14 Jan 2007 17:16:51 -0000
@@ -60,7 +60,7 @@
 
 	void iconPress(int i_num, int offs);
 
-	void transform(int num, int off);
+	void transform(int num, int off, float fact = 0.0);
 	virtual void render();
 
 	void acquireBack();
@@ -87,7 +87,7 @@
 	std::string iconCommand(int i_num);
 
 	/* Focus & unfocus events */
-	void refresh(int mouse_x = -1);
+	void refresh(int mouse_x = -1, int mouse_y = 0);
 
 	/* Icon press events */
 	void iconDown(int i_num);
Index: Main.cc
===================================================================
RCS file: /mnt/back/repository/c/wbar/Main.cc,v
retrieving revision 1.3
diff -u -r1.3 Main.cc
--- Main.cc	14 Jan 2007 17:13:15 -0000	1.3
+++ Main.cc	14 Jan 2007 17:16:51 -0000
@@ -231,9 +231,9 @@
 	    /* Motion Notify *//*{{{*/
 	    case MotionNotify:
 		if(!vertbar)
-		    barra->refresh(ev.xmotion.x);
+		    barra->refresh(ev.xmotion.x, ev.xmotion.y);
 		else
-		    barra->refresh(ev.xmotion.y);
+		    barra->refresh(ev.xmotion.y, ev.xmotion.x);
 		break;
 	    /*}}}*/
 
@@ -247,9 +247,9 @@
 	    case EnterNotify:
 		if(ev.xcrossing.mode!=NotifyUngrab && !(ev.xcrossing.state&Button1Mask)){
 		    if(!vertbar)
-			barra->refresh(ev.xcrossing.x);
+			barra->refresh(ev.xcrossing.x, ev.xcrossing.y);
 		    else
-			barra->refresh(ev.xcrossing.y);
+			barra->refresh(ev.xcrossing.y, ev.xcrossing.x);
 		}
 		break;
 	    /*}}}*/

Index: SuperBar.cc
===================================================================
RCS file: /mnt/back/repository/c/wbar/SuperBar.cc,v
retrieving revision 1.5
diff -u -r1.5 SuperBar.cc
--- SuperBar.cc	14 Jan 2007 17:13:15 -0000	1.5
+++ SuperBar.cc	14 Jan 2007 17:16:51 -0000
@@ -147,8 +147,8 @@
 
     focused = 0;
 
-    x = (int)icon_offset;
-    width = (int)(window->w - 2*icon_offset);
+    //x = (int)icon_offset;
+    //width = (int)(window->w - 2*icon_offset);
     zoomed_icon = -1;
 
     /* Alfa filter the Bar */
